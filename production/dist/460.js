"use strict";(self.webpackChunksleact_ts_front=self.webpackChunksleact_ts_front||[]).push([[460],{47460:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Xe});var r=n(9669),a=n.n(r),o=n(73727),l=n(67294),i=n(69369),c=(0,i.Z)("div",{target:"eh1zqda13"})({name:"tjo4qw",styles:"float:right"}),s=(0,i.Z)("header",{target:"eh1zqda12"})({name:"fvf0bi",styles:"height:38px;background:#350d36;color:#ffffff;box-shadow:0 1px 0 0 rgba(255, 255, 255, 0.1);padding:5px;text-align:center"}),u=(0,i.Z)("div",{target:"eh1zqda10"})({name:"47px7v",styles:"display:flex;padding:20px;& img{display:flex;}&>div{display:flex;flex-direction:column;margin-left:10px;}& #profile-name{font-weight:bold;display:inline-flex;}& #profile-active{font-size:13px;display:inline-flex;}"}),d=(0,i.Z)("button",{target:"eh1zqda9"})({name:"bl1q1k",styles:"border:none;width:100%;border-top:1px solid rgb(29, 28, 29);background:transparent;display:block;height:33px;padding:5px 20px 5px;outline:none;cursor:pointer"}),p=(0,i.Z)("div",{target:"eh1zqda8"})({name:"36bnqj",styles:"display:flex;flex:1"}),f=(0,i.Z)("div",{target:"eh1zqda7"})({name:"17lvj7e",styles:"width:65px;display:inline-flex;flex-direction:column;align-items:center;background:#3f0e40;border-top:1px solid rgb(82, 38, 83);border-right:1px solid rgb(82, 38, 83);vertical-align:top;text-align:center;padding:15px 0 0"}),m=(0,i.Z)("nav",{target:"eh1zqda6"})({name:"2pkygn",styles:"width:260px;display:inline-flex;flex-direction:column;background:#3f0e40;color:rgb(188, 171, 188);vertical-align:top;& a{padding-left:36px;color:inherit;text-decoration:none;height:28px;line-height:28px;display:flex;align-items:center;&.selected{color:white;}}& .bold{color:white;font-weight:bold;}& .count{margin-left:auto;background:#cd2553;border-radius:16px;display:inline-block;font-size:12px;font-weight:700;height:18px;line-height:18px;padding:0 9px;color:white;margin-right:16px;}& h2{height:36px;line-height:36px;margin:0;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;font-size:15px;}"}),h=(0,i.Z)("button",{target:"eh1zqda5"})({name:"1rmthq7",styles:"height:64px;line-height:64px;border:none;width:100%;text-align:left;border-top:1px solid rgb(82, 38, 83);border-bottom:1px solid rgb(82, 38, 83);font-weight:900;font-size:24px;background:transparent;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;padding:0;padding-left:16px;margin:0;color:white;cursor:pointer"}),b=(0,i.Z)("div",{target:"eh1zqda4"})({name:"1146j5j",styles:"height:calc(100vh - 102px);overflow-y:auto"}),g=(0,i.Z)("div",{target:"eh1zqda3"})({name:"192o1ir",styles:"padding:10px 0 0;& h2{padding-left:20px;}&>button{width:100%;height:28px;padding:4px;border:none;background:transparent;border-top:1px solid rgb(28, 29, 28);cursor:pointer;&:last-of-type{border-bottom:1px solid rgb(28, 29, 28);}}"}),y=(0,i.Z)("div",{target:"eh1zqda2"})({name:"82a6rk",styles:"flex:1"}),v=(0,i.Z)("button",{target:"eh1zqda1"})({name:"9tlmej",styles:"color:white;font-size:24px;display:inline-block;width:40px;height:40px;background:transparent;border:none;cursor:pointer"}),w=(0,i.Z)("button",{target:"eh1zqda0"})({name:"wsqixl",styles:"display:inline-block;width:40px;height:40px;border-radius:10px;background:white;border:3px solid #3f0e40;margin-bottom:15px;font-size:18px;font-weight:700;color:black;cursor:pointer"}),x=n(16550),k=n(83564),E=n(95591),S=n(66182),C=n.n(S),O=(0,i.Z)("div",{target:"e1cmoyke1"})({name:"3nqusf",styles:"position:fixed;top:0;right:0;left:0;bottom:0;z-index:1000;&>div{position:absolute;display:inline-block;--saf-0:rgba(var(--sk_foreground_low, 29, 28, 29), 0.13);box-shadow:0 0 0 1px var(--saf-0),0 4px 12px 0 rgba(0, 0, 0, 0.12);background-color:rgba(var(--sk_foreground_min_solid, 248, 248, 248), 1);border-radius:6px;user-select:none;min-width:360px;z-index:512;max-height:calc(100vh - 20px);color:rgb(29, 28, 29);}"}),_=(0,i.Z)("button",{target:"e1cmoyke0"})({name:"19gmbxq",styles:"position:absolute;right:10px;top:6px;background:transparent;border:none;font-size:30px;cursor:pointer"}),A=function(e){var t=e.children,n=e.style,r=e.show,a=e.onCloseModal,o=e.closeButton,i=(0,l.useCallback)((function(e){e.stopPropagation()}),[]);return r?l.createElement(O,{onClick:a},l.createElement("div",{onClick:i,style:n},o&&l.createElement(_,{onClick:a},"×"),t)):null};A.defaultProps={closeButton:!0};const j=A;var Z=n(1409),I=n(38678),P=(0,i.Z)("div",{target:"e1suxgf81"})({name:"10w7pu7",styles:"position:fixed;text-align:center;left:0;bottom:0;top:0;right:0;z-index:1022;&>div{margin-top:200px;display:inline-block;width:440px;background:white;--saf-0:rgba(var(--sk_foreground_low, 29, 28, 29), 0.13);box-shadow:0 0 0 1px var(--saf-0),0 4px 12px 0 rgba(0, 0, 0, 0.12);background-color:rgba(var(--sk_foreground_min_solid, 248, 248, 248), 1);border-radius:6px;user-select:none;max-width:440px;padding:30px 40px 0;z-index:1012;position:relative;}"}),T=(0,i.Z)("button",{target:"e1suxgf80"})({name:"19gmbxq",styles:"position:absolute;right:10px;top:6px;background:transparent;border:none;font-size:30px;cursor:pointer"}),z=function(e){var t=e.show,n=e.children,r=e.onCloseModal,a=e.closeButton,o=(0,l.useCallback)((function(e){e.stopPropagation()}),[]);return t?l.createElement(P,{onClick:r},l.createElement("div",{onClick:o},a&&l.createElement(T,{onClick:r},"×"),n)):null};z.defaultProps={closeButton:!0};const M=z;var D=n(96042);function q(e,t){if(e){if("string"==typeof e)return U(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?U(e,t):void 0}}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const N=function(e){var t,n,r=e.show,o=e.onCloseModal,i=e.setShowCreateChannelModal,c=(t=(0,I.Z)(""),n=3,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,l,i=[],c=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(i.push(r.value),i.length!==t);c=!0);}catch(e){s=!0,a=e}finally{try{if(!c&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw a}}return i}}(t,n)||q(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=c[0],u=c[1],d=c[2],p=(0,x.UO)(),f=p.workspace,m=(p.channel,(0,E.ZP)("".concat("http://localhost:3095","/api/users"),k.Z,{revalidateOnMount:!0})),h=m.data,b=(m.isLoading,m.error,m.mutate,(0,E.ZP)(h?"".concat("http://localhost:3095","/api/workspaces/").concat(f,"/channels"):null,k.Z,{revalidateOnMount:!0})),g=b.data,y=b.mutate,v=(0,l.useCallback)((function(e){e.preventDefault(),a().post("".concat("http://localhost:3095","/api/workspaces/").concat(f,"/channels"),{name:s},{withCredentials:!0}).then((function(e){i(!1),y([].concat(function(e){return function(e){if(Array.isArray(e))return U(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||q(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(g),[e.data]),{revalidate:!1}),d("")})).catch((function(e){var t;console.dir(e),D.Am.error(null===(t=e.response)||void 0===t?void 0:t.data,{position:"bottom-center"})}))}),[s]);return l.createElement(M,{show:r,onCloseModal:o},l.createElement("form",{onSubmit:v},l.createElement(Z.__,{id:"channel-label"},l.createElement("span",null,"채널 이름"),l.createElement(Z.II,{id:"channel",value:s,onChange:u})),l.createElement(Z.zx,{type:"submit"},"생성하기")))};var F=(0,i.Z)("div",{target:"e1w3wjf51"})({name:"1a0r0eh",styles:"display:flex;flex-wrap:wrap;height:calc(100vh - 38px);flex-flow:column;position:relative"}),L=(0,i.Z)("header",{target:"e1w3wjf50"})({name:"1c17pcy",styles:"height:64px;display:flex;width:100%;--saf-0:rgba(var(--sk_foreground_low, 29, 28, 29), 0.13);box-shadow:0 1px 0 var(--saf-0);padding:20px 16px 20px 20px;font-weight:bold;align-items:center;& img{margin-right:5px;}"}),$=n(44593),B=n(85802),R=(0,i.Z)("div",{target:"e1h9ued65"})({name:"ra6cyy",styles:"display:flex;width:100%;padding:20px;padding-top:0"}),W=(0,i.Z)("form",{target:"e1h9ued64"})({name:"33ihw2",styles:"color:rgb(29, 28, 29);font-size:15px;width:100%;border-radius:4px;border:1px solid rgb(29, 28, 29)"}),H=(0,i.Z)(B.r,{target:"e1h9ued63"})({name:"o2sl12",styles:"font-family:Slack-Lato,appleLogo,sans-serif;font-size:15px;padding:8px 9px;width:100%;max-height:500px;& strong{background:skyblue;}& textarea{height:40px;overflow:auto;padding:9px 10px!important;outline:none!important;border-radius:4px!important;resize:none!important;line-height:22px;border:none;}& ul{border:1px solid lightgray;max-height:200px;overflow-y:auto;padding:9px 10px;background:white;border-radius:4px;width:150px;}"}),Y=(0,i.Z)("div",{target:"e1h9ued62"})({name:"13ie2qx",styles:"position:relative;background:rgb(248, 248, 248);height:41px;display:flex;border-top:1px solid rgb(221, 221, 221);align-items:center;border-bottom-left-radius:4px;border-bottom-right-radius:4px"}),K=(0,i.Z)("button",{target:"e1h9ued61"})({name:"xrrdm2",styles:"position:absolute;right:5px;top:5px"}),G=(0,i.Z)("button",{target:"e1h9ued60"})("padding:4px 20px;background:transparent;border:none;display:flex;align-items:center;color:rgb(28, 29, 28);width:100%;& img{margin-right:5px;}",(function(e){return e.focus&&"\n    background: #1264a3;\n    color: white;\n  "}),";");function J(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const Q=(0,l.forwardRef)((function(e,t){var n,r,a=e.chat,o=e.onSubmitForm,i=e.onChangeChat,c=e.placeholder,s=(0,x.UO)(),u=s.workspace,d=(s.id,n=(0,l.useState)(!1),r=2,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,l,i=[],c=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(i.push(r.value),i.length!==t);c=!0);}catch(e){s=!0,a=e}finally{try{if(!c&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw a}}return i}}(n,r)||function(e,t){if(e){if("string"==typeof e)return J(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?J(e,t):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),p=d[0],f=d[1],m=(0,E.ZP)("".concat("http://localhost:3095","/api/workspaces/").concat(u,"/members"),k.Z).data,h=(0,E.ZP)("".concat("http://localhost:3095","/api/users"),k.Z).data,b=(0,l.useCallback)((function(e){"Enter"===e.key&&(!1!==e.nativeEvent.isComposing||e.shiftKey||(e.preventDefault(),o(e)))}),[o]),g=(0,l.useCallback)((function(e,t,n,r,a){if(m)return l.createElement(G,{focus:a},l.createElement("img",{src:C().url(m[r].email,{s:"20px",d:"retro"}),alt:m[r].nickname}),l.createElement("span",null,n))}),[m]);return(0,l.useEffect)((function(){t&&"current"in t&&t.current&&(parseInt(t.current.style.height,10)>=500?f(!0):f(!1))}),[a]),m&&h?l.createElement(R,null,l.createElement(W,{onSubmit:o},l.createElement(H,{id:"editor-chat",value:a,placeholder:c,onChange:i,onKeyDown:b,inputRef:t,style:p?{overflowY:"auto"}:{},forceSuggestionsAboveCursor:!0},l.createElement(B.p,{appendSpaceOnAdd:!0,trigger:"@",data:(null==m?void 0:m.map((function(e){return{id:e.id,display:e.nickname}})))||[],renderSuggestion:g})),l.createElement(Y,null,l.createElement(K,{onClick:o,className:"c-button-unstyled c-icon_button c-icon_button--light c-icon_button--size_medium c-texty_input__button c-texty_input__button--send"+(null!=a&&a.trim()?"":" c-texty_input__button--disabled"),"data-qa":"texty_send_button","aria-label":"Send message","data-sk":"tooltip_parent",type:"submit",disabled:!(null!=a&&a.trim())},l.createElement("i",{className:"c-icon c-icon--paperplane-filled","area-hidden":"true"}))))):null}));var V=(0,i.Z)("div",{target:"e2rvgva2"})({name:"1op36e9",styles:"width:100%;display:flex;flex:1"}),X=(0,i.Z)("section",{target:"e2rvgva1"})({name:"10zp55f",styles:"margin-top:20px;border-top:1px solid #eee"}),ee=(0,i.Z)("div",{target:"e2rvgva0"})({name:"13fx9vx",styles:"display:flex;justify-content:center;flex:1;width:100%;position:sticky;top:20px;& button{font-weight:bold;font-size:13px;height:28px;line-height:27px;padding:0 16px;z-index:2;--saf-0:rgba(var(--sk_foreground_low, 29, 28, 29), 0.13);box-shadow:0 0 0 1px var(--saf-0),0 1px 3px 0 rgba(0, 0, 0, 0.08);border-radius:24px;position:relative;top:-13px;background:white;border:none;outline:none;}"}),te=n(31298),ne=(0,i.Z)("div",{target:"e1ydbz500"})({name:"2yhi1c",styles:"display:flex;padding:8px 20px;&:hover{background:#eee;}& .chat-img{display:flex;width:36px;margin-right:8px;& img{width:36px;height:36px;}}& .chat-text{display:flex;flex-wrap:wrap;flex:1;& p{flex:0 0 100%;margin:0;}}& .chat-user{display:flex;flex:0 0 100%;align-items:center;&>b{margin-right:5px;}&>span{font-size:12px;}}& a{text-decoration:none;color:deepskyblue;}"}),re=n(38817),ae=n(27484),oe=n.n(ae),le=function(e){var t=e.data,n=(0,x.UO)(),r=n.workspace,a=(n.id,"Sender"in t?t.Sender:t.User),i=(0,l.useMemo)((function(){return t.content.startsWith("uploads/")?l.createElement("img",{src:"".concat("http://localhost:3095","/").concat(t.content),style:{maxHeight:200}}):(0,re.Z)({input:t.content,pattern:/@\[(.+?)]\((\d+?)\)|\n/g,decorator:function(e,t){var n=e.match(/@\[(.+?)]\((\d+?)\)/);return n?l.createElement(o.rU,{key:e+t,to:"/workspace/".concat(r,"/dm/").concat(n[2])},"@",n[1]):l.createElement("br",{key:t})}})}),[t.content]);return l.createElement(ne,null,l.createElement("div",{className:"chat-img"},l.createElement("img",{src:C().url(a.nickname,{s:"36px",d:"retro"}),alt:a.nickname})),l.createElement("div",{className:"chat-text"},l.createElement("div",{className:"chat-user"},l.createElement("b",null,a.nickname),l.createElement("span",null,oe()(t.createdAt).format("h:mm A"))),l.createElement("p",null,i)))};const ie=(0,l.memo)(le);function ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n(19132),oe().locale("ko");const se=(0,l.forwardRef)((function(e,t){var n=e.chatSections,r=e.setSize,a=e.isEmpty,o=e.isReachingEnd,i=e.refCopy,c=(0,l.useCallback)((function(e){0!==e.scrollTop||o||a||r((function(e){return e+1})).then((function(){i&&i.scrollTop((null==i?void 0:i.getScrollHeight())-e.scrollHeight)}))}),[o,a,i]);return l.createElement(V,null,l.createElement(te.$B,{autoHide:!0,ref:t,onScrollFrame:c},n&&Object.entries(n).map((function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,l,i=[],c=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(i.push(r.value),i.length!==t);c=!0);}catch(e){s=!0,a=e}finally{try{if(!c&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw a}}return i}}(t,n)||function(e,t){if(e){if("string"==typeof e)return ce(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ce(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=r[0],o=r[1];return l.createElement(X,{className:"section-".concat(a),key:a},l.createElement(ee,null,l.createElement("button",null,oe()(a).format("M월 D일 dddd"))),null==o?void 0:o.map((function(e,t){return l.createElement(ie,{key:e.id+t,data:e})})))}))))}));var ue=n(3682);function de(e){var t={};return e.forEach((function(e){var n=oe()(e.createdAt).format("YYYY-MM-DD");Array.isArray(t[n])?t[n].push(e):t[n]=[e]})),t}var pe=n(32177),fe={};const me=function(e){var t=(0,l.useCallback)((function(){e&&(fe[e].disconnect(),delete fe[e])}),[e]);return e?(fe[e]||(fe[e]=(0,pe.ZP)("".concat("http://localhost:3095","/ws-").concat(e),{transports:["websocket"]})),[fe[e],t]):[void 0,t]};function he(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function be(e,t){var n,r=new Array;return r.push((n=t,function(e){if(Array.isArray(e))return he(e)}(n)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||function(e,t){if(e){if("string"==typeof e)return he(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?he(e,t):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).sort((function(e,t){return t.id-e.id}))),e.map((function(e){return r.push(e.sort((function(e,t){return t.id-e.id})))})),r}var ge=(0,i.Z)("div",{target:"e115zb6i2"})({name:"1a0r0eh",styles:"display:flex;flex-wrap:wrap;height:calc(100vh - 38px);flex-flow:column;position:relative"}),ye=(0,i.Z)("header",{target:"e115zb6i1"})({name:"1ezwwi6",styles:"height:64px;display:flex;width:100%;--saf-0:rgba(var(--sk_foreground_low, 29, 28, 29), 0.13);box-shadow:0 1px 0 var(--saf-0);padding:20px 16px 20px 20px;font-weight:bold;align-items:center;& .header-right{display:flex;flex:1;justify-content:flex-end;align-items:center;}"}),ve=(0,i.Z)("div",{target:"e115zb6i0"})({name:"czjct4",styles:"position:absolute;top:64px;left:0;width:100%;height:calc(100% - 64px);background:white;opacity:0.7;display:flex;align-items:center;justify-content:center;font-size:40px"});function we(e){return function(e){if(Array.isArray(e))return Ee(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ke(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,l,i=[],c=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(i.push(r.value),i.length!==t);c=!0);}catch(e){s=!0,a=e}finally{try{if(!c&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw a}}return i}}(e,t)||ke(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ke(e,t){if(e){if("string"==typeof e)return Ee(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ee(e,t):void 0}}function Ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const Se=function(){var e,t,n=(0,x.UO)(),r=n.workspace,o=n.id,i=xe((0,l.useState)([]),2),c=i[0],s=i[1],u=(0,E.ZP)("".concat("http://localhost:3095","/api/workspaces/").concat(r,"/users/").concat(o),k.Z).data,d=(0,E.ZP)("".concat("http://localhost:3095","/api/users"),k.Z).data,p=(0,$.ZP)((function(e){return"".concat("http://localhost:3095","/api/workspaces/").concat(r,"/dms/").concat(o,"/chats?perPage=20&page=").concat(e+1)}),k.Z,{revalidateOnFocus:!1}),f=p.data,m=p.mutate,h=p.setSize,b=xe(me(r),1)[0],g=xe((0,I.Z)(""),3),y=g[0],v=g[1],w=g[2],S=xe((0,l.useState)(!1),2),O=S[0],_=S[1],A=0===(null==f||null===(e=f[0])||void 0===e?void 0:e.length),j=A||f&&(null===(t=f[f.length-1])||void 0===t?void 0:t.length)<20||!1,Z=(0,l.useRef)(null),P=xe((0,l.useState)(),2),T=P[0],z=P[1],M=(0,l.useCallback)((function(e){null!==e&&(z(e),1===(null==f?void 0:f.length)&&e.scrollToBottom())}),[f]);(0,l.useEffect)((function(){Z.current&&(0,ue.Z)(Z.current)}),[y]),(0,l.useEffect)((function(){s([])}),[o,f]);var q=(0,l.useCallback)((function(e){if(e.preventDefault(),null!=y&&y.trim()&&f){var t=y;m((function(e){return s((function(e){var n,r;return[{id:(0!==e.length?null===(n=e[0])||void 0===n?void 0:n.id:(null===(r=f[0][0])||void 0===r?void 0:r.id)||0)+1,content:t,SenderId:d.id,Sender:d,ReceiverId:u.id,Receiver:u,createdAt:new Date}].concat(we(e))})),e}),{revalidate:!1}).then((function(){localStorage.setItem("".concat(r,"-").concat(o),(new Date).getTime().toString()),w(""),Z.current&&(Z.current.style.height="40px"),null==T||T.scrollToBottom()})),a().post("".concat("http://localhost:3095","/api/workspaces/").concat(r,"/dms/").concat(o,"/chats"),{content:t},{withCredentials:!0}).then((function(e){})).catch((function(e){var t;console.dir(e),D.Am.error(null===(t=e.response)||void 0===t?void 0:t.data,{position:"bottom-center"})}))}}),[y,f,d,u,r,o]),U=(0,l.useMemo)((function(){return de(f?be(f,c).flat().sort((function(e,t){return e.id-t.id})):[])}),[f,c]),N=(0,l.useCallback)((function(e){e.SenderId===Number(o)&&d.id!==Number(o)&&m((function(t){return s((function(t){return[e].concat(we(t))})),t}),{revalidate:!1}).then((function(){localStorage.setItem("".concat(r,"-").concat(o),(new Date).getTime().toString()),T&&T.getScrollHeight()<T.getClientHeight()+T.getScrollTop()+150&&T.scrollToBottom()}))}),[f]);(0,l.useEffect)((function(){return null==b||b.on("dm",N),function(){null==b||b.off("dm",N)}}),[b,N]),(0,l.useEffect)((function(){localStorage.setItem("".concat(r,"-").concat(o),(new Date).getTime().toString())}),[r,o]);var B=(0,l.useCallback)((function(e){e.preventDefault();var t=new FormData;if(e.dataTransfer.items)for(var n=0;n<e.dataTransfer.items.length;n++){if("file"!==e.dataTransfer.items[n].kind)return;var l=e.dataTransfer.items[n].getAsFile();t.append("image",l)}else for(var i=0;i<e.dataTransfer.files.length;i++)t.append("image",e.dataTransfer.files[i]);a().post("".concat("http://localhost:3095","/api/workspaces/").concat(r,"/dms/").concat(o,"/images"),t).then((function(){_(!1),m()}))}),[r,o]),R=(0,l.useCallback)((function(e){if(e.preventDefault(),e.dataTransfer.items)for(var t=0;t<e.dataTransfer.items.length;t++)if("file"!==e.dataTransfer.items[t].kind)return;_(!0)}),[]),W=(0,l.useCallback)((function(e){e.preventDefault(),_(!1)}),[]);return u&&d?l.createElement(F,{onDrop:B,onDragOver:R},l.createElement(L,null,l.createElement("img",{src:C().url(null==u?void 0:u.nickname,{s:"36px",d:"retro"}),alt:u.email}),l.createElement("span",null,u.nickname)),l.createElement(se,{ref:M,refCopy:T,chatSections:U,setSize:h,isEmpty:A,isReachingEnd:j}),l.createElement(Q,{ref:Z,chat:y,onSubmitForm:q,onChangeChat:v,placeholder:"".concat(u.nickname,"에 메시지 보내기")}),O&&l.createElement(ve,{onDragLeave:W},"드래그 앤 드롭하여 업로드!")):null};function Ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const Oe=function(e){var t,n,r=e.show,o=e.onCloseModal,i=e.setShowInviteChannelModal,c=(0,x.UO)(),s=c.workspace,u=c.channel,d=(t=(0,I.Z)(""),n=3,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,l,i=[],c=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(i.push(r.value),i.length!==t);c=!0);}catch(e){s=!0,a=e}finally{try{if(!c&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw a}}return i}}(t,n)||function(e,t){if(e){if("string"==typeof e)return Ce(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ce(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),p=d[0],f=d[1],m=d[2],h=(0,E.ZP)("".concat("http://localhost:3095",":/api/users"),k.Z).data,b=(0,E.ZP)(h?"".concat("http://localhost:3095","/api/workspaces/").concat(s,"/channels/").concat(u,"/members"):null,k.Z).mutate,g=(0,l.useCallback)((function(e){e.preventDefault(),p&&p.trim()&&a().post("".concat("http://localhost:3095","/api/workspaces/").concat(s,"/channels/").concat(u,"/member"),{email:p},{withCredentials:!0}).then((function(e){b(),i(!1),m("")})).catch((function(e){var t;console.dir(e),D.Am.error(null===(t=e.response)||void 0===t?void 0:t.data,{position:"bottom-center"})}))}),[]);return l.createElement(M,{show:r,onCloseModal:o},l.createElement("form",{onSubmit:g},l.createElement(Z.__,{id:"member-label"},l.createElement("span",null,"채널 멤버 초대"),l.createElement(Z.II,{id:"member",value:p,onChange:f})),l.createElement(Z.zx,{type:"submit"},"초대하기")))};function _e(e){return function(e){if(Array.isArray(e))return Ze(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||je(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ae(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,l,i=[],c=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(i.push(r.value),i.length!==t);c=!0);}catch(e){s=!0,a=e}finally{try{if(!c&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw a}}return i}}(e,t)||je(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function je(e,t){if(e){if("string"==typeof e)return Ze(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ze(e,t):void 0}}function Ze(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const Ie=function(){var e,t,n=(0,x.UO)(),r=n.workspace,o=n.channel,i=Ae((0,l.useState)([]),2),c=i[0],s=i[1],u=(0,E.ZP)("".concat("http://localhost:3095","/api/users"),k.Z).data,d=(0,$.ZP)((function(e){return"".concat("http://localhost:3095","/api/workspaces/").concat(r,"/channels/").concat(o,"/chats?perPage=20&page=").concat(e+1)}),k.Z,{revalidateOnFocus:!1}),p=d.data,f=d.mutate,m=d.setSize,h=(0,E.ZP)("".concat("http://localhost:3095","/api/workspaces/").concat(r,"/channels/").concat(o),k.Z,{revalidateOnFocus:!1}).data,b=(0,E.ZP)(u?"".concat("http://localhost:3095","/api/workspaces/").concat(r,"/channels/").concat(o,"/members"):null,k.Z,{revalidateOnFocus:!1}).data,g=Ae(me(r),1)[0],y=Ae((0,I.Z)(""),3),v=y[0],w=y[1],S=y[2],C=Ae((0,l.useState)(!1),2),O=C[0],_=C[1],A=Ae((0,l.useState)(!1),2),j=A[0],Z=A[1],P=0===(null==p||null===(e=p[0])||void 0===e?void 0:e.length),T=P||p&&(null===(t=p[p.length-1])||void 0===t?void 0:t.length)<20||!1,z=(0,l.useRef)(null),M=Ae((0,l.useState)(),2),q=M[0],U=M[1],N=(0,l.useCallback)((function(e){null!==e&&(U(e),1===(null==p?void 0:p.length)&&e.scrollToBottom())}),[p]);(0,l.useEffect)((function(){z.current&&(0,ue.Z)(z.current)}),[v]),(0,l.useEffect)((function(){s([])}),[o,p]);var F=(0,l.useCallback)((function(e){if(e.preventDefault(),null!=v&&v.trim()&&p&&h){var t=v;f((function(e){return s((function(e){var n,r;return[{id:(0!==e.length?null===(n=e[0])||void 0===n?void 0:n.id:(null===(r=p[0][0])||void 0===r?void 0:r.id)||0)+1,content:t,UserId:u.id,User:u,ChannelId:h.id,Channel:h,createdAt:new Date}].concat(_e(e))})),e}),{revalidate:!1}).then((function(){localStorage.setItem("".concat(r,"-").concat(o),(new Date).getTime().toString()),S(""),z.current&&(z.current.style.height="40px"),null==q||q.scrollToBottom()})),a().post("".concat("http://localhost:3095","/api/workspaces/").concat(r,"/channels/").concat(o,"/chats"),{content:t},{withCredentials:!0}).then((function(e){})).catch((function(e){var t;console.dir(e),D.Am.error(null===(t=e.response)||void 0===t?void 0:t.data,{position:"bottom-center"})}))}}),[v,p,u,h,r,o]),L=(0,l.useMemo)((function(){return de(p?be(p,c).flat().sort((function(e,t){return e.id-t.id})):[])}),[p,c]),B=(0,l.useCallback)((function(){_(!0)}),[]),R=(0,l.useCallback)((function(){_(!1)}),[]),W=(0,l.useCallback)((function(e){e.Channel.name!==o||!e.content.startsWith("uploads/")&&(null==u?void 0:u.id)===e.UserId||f((function(t){return s((function(t){return[e].concat(_e(t))})),t}),{revalidate:!1}).then((function(){localStorage.setItem("".concat(r,"-").concat(o),(new Date).getTime().toString()),q&&q.getScrollHeight()<q.getClientHeight()+q.getScrollTop()+150&&q.scrollToBottom()}))}),[o,u]);(0,l.useEffect)((function(){return null==g||g.on("message",W),function(){null==g||g.off("message",W)}}),[g,W]),(0,l.useEffect)((function(){localStorage.setItem("".concat(r,"-").concat(o),(new Date).getTime().toString())}),[r,o]);var H=(0,l.useCallback)((function(e){e.preventDefault();var t=new FormData;if(e.dataTransfer.items)for(var n=0;n<e.dataTransfer.items.length;n++){if("file"!==e.dataTransfer.items[n].kind)return;var l=e.dataTransfer.items[n].getAsFile();t.append("image",l)}else for(var i=0;i<e.dataTransfer.files.length;i++)t.append("image",e.dataTransfer.files[i]);a().post("".concat("http://localhost:3095","/api/workspaces/").concat(r,"/channels/").concat(o,"/images"),t).then((function(){localStorage.setItem("".concat(r,"-").concat(o),(new Date).getTime().toString()),Z(!1),f()}))}),[r,o]),Y=(0,l.useCallback)((function(e){if(e.preventDefault(),e.dataTransfer.items)for(var t=0;t<e.dataTransfer.items.length;t++)if("file"!==e.dataTransfer.items[t].kind)return;Z(!0)}),[]),K=(0,l.useCallback)((function(e){e.preventDefault(),Z(!1)}),[]);return u?l.createElement(ge,{onDrop:H,onDragOver:Y},l.createElement(ye,null,l.createElement("span",null,"#",o),l.createElement("div",{className:"header-right"},l.createElement("span",null,null==b?void 0:b.length),l.createElement("button",{onClick:B,className:"c-button-unstyled p-ia__view_header__button","aria-label":"Add people to #react-native","data-sk":"tooltip_parent",type:"button"},l.createElement("i",{className:"c-icon p-ia__view_header__button_icon c-icon--add-user","aria-hidden":"true"})))),l.createElement(se,{ref:N,refCopy:q,chatSections:L,setSize:m,isEmpty:P,isReachingEnd:T}),l.createElement(Q,{ref:z,chat:v,onSubmitForm:F,onChangeChat:w,placeholder:"#".concat(o,"에 메시지 보내기")}),l.createElement(Oe,{show:O,onCloseModal:R,setShowInviteChannelModal:_}),j&&l.createElement(ve,{onDragLeave:K},"드래그 앤 드롭하여 업로드!")):null};function Pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const Te=function(e){var t,n,r=e.show,o=e.onCloseModal,i=e.setShowInviteWorkspaceModal,c=(0,x.UO)().workspace,s=(0,E.ZP)("".concat("http://localhost:3095",":/api/users"),k.Z).data,u=(0,E.ZP)(s?"".concat("http://localhost:3095","/api/workspaces/").concat(c,"/members"):null,k.Z).mutate,d=(t=(0,I.Z)(""),n=3,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,l,i=[],c=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(i.push(r.value),i.length!==t);c=!0);}catch(e){s=!0,a=e}finally{try{if(!c&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw a}}return i}}(t,n)||function(e,t){if(e){if("string"==typeof e)return Pe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Pe(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),p=d[0],f=d[1],m=d[2],h=(0,l.useCallback)((function(e){e.preventDefault(),p&&p.trim()&&a().post("".concat("http://localhost:3095","/api/workspaces/").concat(c,"/members"),{email:p},{withCredentials:!0}).then((function(e){u(),i(!1),m("")})).catch((function(e){var t;console.dir(e),D.Am.error(null===(t=e.response)||void 0===t?void 0:t.data,{position:"bottom-center"})}))}),[c,p]);return l.createElement(M,{show:r,onCloseModal:o},l.createElement("form",{onSubmit:h},l.createElement(Z.__,{id:"member-label"},l.createElement("span",null,"이메일"),l.createElement(Z.II,{id:"member",type:"email",value:p,onChange:f})),l.createElement(Z.zx,{type:"submit"},"초대하기")))};var ze=(0,i.Z)("button",{target:"e1xt6uxw0"})("background:transparent;border:none;width:26px;height:26px;display:inline-flex;justify-content:center;align-items:center;color:white;margin-left:10px;cursor:pointer;",(function(e){return e.collapse&&"\n    & i {\n      transform: none;\n    }\n  "}),";");const Me=function(e){var t=e.member,n=e.isOnline,r=(0,x.UO)().workspace,a=(0,x.TH)(),i=(0,E.ZP)("".concat("http://localhost:3095","/api/users"),k.Z,{revalidateOnMount:!0}).data,c=localStorage.getItem("".concat(r,"-").concat(t.id)),s=(0,E.ZP)(i?"".concat("http://localhost:3095","/api/workspaces/").concat(r,"/dms/").concat(t.id,"/unreads?after=").concat(c):null,k.Z),u=s.data,d=s.mutate;return(0,l.useEffect)((function(){a.pathname==="/workspace/".concat(r,"/dm/").concat(t.id)&&d(0)}),[a.pathname,r,t]),l.createElement(o.OL,{key:t.id,activeStyle:{fontWeight:"bold",color:"white"},to:"/workspace/".concat(r,"/dm/").concat(t.id)},l.createElement("div",{style:{position:"relative",width:"35px",height:"30px"}},l.createElement("img",{className:"c-base_icon c-base_icon--image",style:{position:"absolute",top:"0",left:"0"},src:C().url(t.nickname,{s:"25px",d:"retro"}),alt:t.email}),l.createElement("i",{className:"c-icon p-channel_sidebar__presence_icon p-channel_sidebar__presence_icon--dim_enabled c-presence ".concat(n?"c-presence--active c-icon--presence-online":"c-icon--presence-offline"),"aria-hidden":"true","data-qa":"presence_indicator","data-qa-presence-self":"false","data-qa-presence-active":"false","data-qa-presence-dnd":"false",style:{top:"10px",left:"15px"}})),l.createElement("span",{className:u&&u>0?"bold":void 0},t.nickname),t.id===(null==i?void 0:i.id)&&l.createElement("span",null," (나)"),u&&u>0&&l.createElement("span",{className:"count"},u)||null)};function De(e){return De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},De(e)}function qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qe(Object(n),!0).forEach((function(t){Ne(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ne(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==De(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==De(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===De(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Fe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,l,i=[],c=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(i.push(r.value),i.length!==t);c=!0);}catch(e){s=!0,a=e}finally{try{if(!c&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw a}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Le(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Le(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Le(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const $e=function(){var e=(0,x.UO)().workspace,t=(0,E.ZP)("".concat("http://localhost:3095","/api/users"),k.Z,{revalidateOnMount:!0}).data,n=(0,E.ZP)(t?"".concat("http://localhost:3095","/api/workspaces/").concat(e,"/members"):null,k.Z).data,r=Fe((0,l.useState)(!1),2),a=r[0],o=r[1],i=Fe((0,l.useState)({}),2),c=(i[0],i[1]),s=Fe((0,l.useState)([]),2),u=s[0],d=s[1],p=Fe(me(e),1)[0],f=(0,l.useCallback)((function(){o((function(e){return!e}))}),[]),m=((0,l.useCallback)((function(e){return function(){c((function(t){return Ue(Ue({},t),{},Ne({},e,0))}))}}),[]),(0,l.useCallback)((function(){}),[e]));return(0,l.useEffect)((function(){return null==p||p.on("onlineList",(function(e){d(e)})),null==p||p.on("dm",m),console.log("socket on dm",null==p?void 0:p.hasListeners("dm"),p),function(){null==p||p.off("dm",m),console.log("socket off dm",null==p?void 0:p.hasListeners("dm")),null==p||p.off("onlineList")}}),[p]),l.createElement(l.Fragment,null,l.createElement("h2",null,l.createElement(ze,{collapse:a,onClick:f},l.createElement("i",{className:"c-icon p-channel_sidebar__section_heading_expand p-channel_sidebar__section_heading_expand--show_more_feature c-icon--caret-right c-icon--inherit c-icon--inline","data-qa":"channel-section-collapse","aria-hidden":"true"})),l.createElement("span",null,"Direct Messages")),l.createElement("div",null,!a&&(null==n?void 0:n.map((function(e){var t=u.includes(e.id);return l.createElement(Me,{key:"member"+e.id,member:e,isOnline:t})})))))},Be=function(e){var t=e.channel,n=(0,x.UO)().workspace,r=(0,x.TH)(),a=(0,E.ZP)("".concat("http://localhost:3095","/api/users"),k.Z,{revalidateOnMount:!0}).data,i=localStorage.getItem("".concat(n,"-").concat(t.name))||0,c=(0,E.ZP)(a?"".concat("http://localhost:3095","/api/workspaces/").concat(n,"/channels/").concat(t.name,"/unreads?after=").concat(i):null,k.Z),s=c.data,u=c.mutate;return(0,l.useEffect)((function(){r.pathname==="/workspace/".concat(n,"/channel/").concat(t.name)&&u(0)}),[u,r.pathname,n,t]),l.createElement(o.OL,{key:t.name,activeStyle:{fontWeight:"bold",color:"white"},to:"/workspace/".concat(n,"/channel/").concat(t.name)},l.createElement("span",{className:void 0!==s&&s>0?"bold":void 0},"# ",t.name),void 0!==s&&s>0&&l.createElement("span",{className:"count"},s))};function Re(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const We=function(e){!function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(e);var t,n,r=(0,x.UO)().workspace,a=(0,E.ZP)("".concat("http://localhost:3095","/api/users"),k.Z,{revalidateOnMount:!0}).data,o=(0,E.ZP)(a?"".concat("http://localhost:3095","/api/workspaces/").concat(r,"/channels"):null,k.Z).data,i=(t=(0,l.useState)(!1),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,l,i=[],c=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(i.push(r.value),i.length!==t);c=!0);}catch(e){s=!0,a=e}finally{try{if(!c&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw a}}return i}}(t,n)||function(e,t){if(e){if("string"==typeof e)return Re(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Re(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=i[0],s=i[1],u=(0,l.useCallback)((function(){s((function(e){return!e}))}),[]);return l.createElement(l.Fragment,null,l.createElement("h2",null,l.createElement(ze,{collapse:c,onClick:u},l.createElement("i",{className:"c-icon p-channel_sidebar__section_heading_expand p-channel_sidebar__section_heading_expand--show_more_feature c-icon--caret-right c-icon--inherit c-icon--inline","data-qa":"channel-section-collapse","aria-hidden":"true"})),l.createElement("span",null,"Channels")),l.createElement("div",null,!c&&(null==o?void 0:o.map((function(e){return l.createElement(Be,{key:e.id,channel:e})})))))};function He(e){return He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},He(e)}function Ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ye(Object(n),!0).forEach((function(t){Ge(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ge(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==He(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==He(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===He(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Je(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,l,i=[],c=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(i.push(r.value),i.length!==t);c=!0);}catch(e){s=!0,a=e}finally{try{if(!c&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw a}}return i}}(e,t)||Qe(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qe(e,t){if(e){if("string"==typeof e)return Ve(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ve(e,t):void 0}}function Ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const Xe=function(e){e.children;var t,n=(0,x.UO)().workspace,r=(0,E.ZP)("".concat("http://localhost:3095","/api/users"),k.Z,{revalidateOnMount:!0}),i=r.data,S=r.isLoading,O=(r.error,r.mutate),_=(0,E.ZP)(i?"".concat("http://localhost:3095","/api/workspaces/").concat(n,"/channels"):null,k.Z,{revalidateOnMount:!0}).data,A=Je((0,l.useState)(!1),2),P=A[0],T=A[1],z=Je((0,l.useState)(!1),2),q=z[0],U=z[1],F=Je((0,l.useState)(!1),2),L=F[0],$=F[1],B=Je((0,l.useState)(!1),2),R=B[0],W=B[1],H=Je((0,l.useState)(!1),2),Y=H[0],K=H[1],G=Je((0,l.useState)(!1),2),J=G[0],Q=G[1],V=Je((0,I.Z)(""),3),X=V[0],ee=V[1],te=V[2],ne=Je((0,I.Z)(""),3),re=ne[0],ae=ne[1],oe=ne[2],le=Je(me(n),2),ie=le[0],ce=le[1];(0,l.useEffect)((function(){_&&i&&ie&&ie.emit("login",{id:i.id,channels:_.map((function(e){return e.id}))})}),[ie,i,_]),(0,l.useEffect)((function(){return function(){ce()}}),[n,ce]);var se=(0,l.useCallback)((function(){a().post("".concat("http://localhost:3095","/api/users/logout"),null,{withCredentials:!0}).then((function(){O(!1,{revalidate:!1})}))}),[]),ue=(0,l.useCallback)((function(e){e.stopPropagation(),T((function(e){return!e}))}),[]),de=(0,l.useCallback)((function(){$(!0)}),[]),pe=(0,l.useCallback)((function(){$(!1),W(!1),K(!1),Q(!1)}),[]),fe=(0,l.useCallback)((function(e){e.preventDefault(),X&&X.trim()&&re&&re.trim()&&a().post("".concat("http://localhost:3095","/api/workspaces"),{workspace:X,url:re},{withCredentials:!0}).then((function(e){var t;i&&O(Ke(Ke({},i),{},{Workspaces:[].concat((t=i.Workspaces,function(e){if(Array.isArray(e))return Ve(e)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||Qe(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),[e.data])}),{revalidate:!1}),$(!1),te(""),oe("")})).catch((function(e){var t;console.dir(e),D.Am.error(null===(t=e.response)||void 0===t?void 0:t.data,{position:"bottom-center"})}))}),[X,re]),he=(0,l.useCallback)((function(){U((function(e){return!e}))}),[]),be=(0,l.useCallback)((function(){U((function(e){return!e})),W(!0)}),[]),ge=(0,l.useCallback)((function(){U((function(e){return!e})),K(!0)}),[]);return S||i?i?l.createElement("div",null,l.createElement(s,null,l.createElement(c,null,l.createElement("span",{onClick:ue},S?l.createElement("div",null,"로딩 중..."):l.createElement(l.Fragment,null,l.createElement("div",{style:{position:"relative",width:"35px",height:"30px"}},l.createElement("img",{className:"c-base_icon c-base_icon--image",style:{position:"absolute",top:"0",left:"0"},src:C().url(i.nickname,{s:"25px",d:"retro"}),alt:i.email}),l.createElement("i",{className:"c-icon p-channel_sidebar__presence_icon p-channel_sidebar__presence_icon--dim_enabled c-presence c-presence--active c-icon--presence-online","aria-hidden":"true","data-qa":"presence_indicator","data-qa-presence-self":"false","data-qa-presence-active":"false","data-qa-presence-dnd":"false",style:{top:"10px",left:"10px"}})),P?l.createElement(j,{style:{right:0,top:38},show:P,onCloseModal:ue},l.createElement(u,null,l.createElement("img",{src:C().url(null==i?void 0:i.nickname,{s:"36px",d:"retro"}),alt:i.email}),l.createElement("div",null,l.createElement("span",{id:"profile-name"},null==i?void 0:i.nickname),l.createElement("span",{id:"profile-active"},"active"))),l.createElement(d,{onClick:se},"로그아웃")):null)))),l.createElement(p,null,l.createElement(f,null,S?l.createElement("div",null,"로딩 중..."):null==i||null===(t=i.Workspaces)||void 0===t?void 0:t.map((function(e){return l.createElement(o.rU,{key:e.id,to:"/workspace/".concat(e.url,"/channel/일반")},l.createElement(w,null,e.name.slice(0,1).toUpperCase()))})),l.createElement(v,{onClick:de},"+")),l.createElement(m,null,l.createElement(h,{onClick:he},n),l.createElement(b,null,l.createElement(j,{show:q,onCloseModal:he,style:{top:95,left:80}},l.createElement(g,null,l.createElement("h2",null,n),l.createElement("button",{onClick:ge},"워크스페이스에 사용자 초대"),l.createElement("button",{onClick:be},"채널 만들기"),l.createElement("button",{onClick:se},"로그아웃"))),l.createElement(We,null),l.createElement($e,null))),l.createElement(y,null,l.createElement(x.rs,null,l.createElement(x.AW,{path:"/workspace/:workspace/channel/:channel",component:Ie}),l.createElement(x.AW,{path:"/workspace/:workspace/dm/:id",component:Se})))),l.createElement(M,{show:L,onCloseModal:pe},l.createElement("form",{onSubmit:fe},l.createElement(Z.__,{id:"workspace-label"},l.createElement("span",null,"워크스페이스 이름"),l.createElement(Z.II,{id:"workspace",value:X,onChange:ee})),l.createElement(Z.__,{id:"workspace-url-label"},l.createElement("span",null,"워크스페이스 URL"),l.createElement(Z.II,{id:"workspace",value:re,onChange:ae})),l.createElement(Z.zx,{type:"submit"},"생성하기"))),l.createElement(N,{show:R,onCloseModal:pe,setShowCreateChannelModal:W}),l.createElement(Te,{show:Y,onCloseModal:pe,setShowInviteWorkspaceModal:K}),l.createElement(Oe,{show:J,onCloseModal:pe,setShowInviteChannelModal:Q})):null:l.createElement(x.l_,{to:"/login"})}}}]);